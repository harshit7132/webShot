<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <title>WebShot</title>
    <script src="{{ url_for('static', filename='script.js') }}" defer></script>

</head>

<body>

   <!-- Floating Icon -->
   <div class="floating-icon">
        <a href="{{ url_for('jarvis') }}"><i class="fas fa-robot" style="font-size: 18px;"></i></a> <!-- Replace with any FontAwesome icon -->
    </div>

        <!-- Tooltip Bubble -->
            <div class="tooltip-bubble">
                    I am your AI assistant
            </div>

    <!-- ========== Start Navbar Section ========== -->
    <header class="section-navbar" id="Home">
        <div class="container">
            <div class="navbar-brand">
                <a href="#">
                    <h1>WebShot</h1>
                </a>
            </div>
            <nav class="navbar">
                <ul style="list-style-type: none;">
                    <li class="nav-items"> <a class="nav-link" href="#about">About </a> </li>
                    <li class="nav-items"> <a class="nav-link" href="#tech"> Tech </a> </li>
                    <li class="nav-items"> <a class="nav-link" href="#contach"> Contact </a> </li>
                    <li class="nav-items"> <a class="nav-link" href="{{ url_for('history')}}">History</a></li>
                </ul>

                <ul style="list-style-type: none;">
                    <li class="nav-items">
                        <a class="nav-link btn btn-primary" id="login-btn" href="{{ url_for('login') }}">Log In</a>
                    </li>
                </ul>

                <ul style="list-style-type: none;">
                    <li class="nav-items" id="profile-text"> <a class="nav-link"
                            href="{{ url_for('profile') }}">Profile</a></li>
                    <li class="nav-items">
                        <a class="nav-link btn btn-primary" id="logout-btn" href="{{ url_for('login') }}">Log Out</a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>
    <!-- ========== End Navbar Section ========== -->

    <!-- ========== Start Hero Section ========== -->
    <main>
        <section class="hero-section">
            <div class="container grid grid-two--cols">
                <div class="hero-containt">
                    <div class="hero-subheading">
                        <marquee direction="left"> Be lazy coder... </marquee>
                    </div>
                    <div class="hero-heading">
                        <h2> Extract <br> your code </h2>
                    </div>
                </div>
                <div class="hero-image">
                    <figure>
                        <script type="module" src="{{ url_for('static', filename='js/spline-viewer.js') }}"></script>
                        <spline-viewer frame
                            url="{{ url_for('static', filename='models/scene.splinecode') }}"></spline-viewer>
                    </figure>

                </div>
            </div>
        </section>
    </main>
    <!-- ========== End Hero Section ========== -->

    <section class="aknowledgement-section">

        <div class="container">
            <div class="title-heading">
                <h2> Aknowledgement </h2>
            </div>
            <div class="title-subheading">
                <br>
                <p> The satisfaction and euphoria that accompany the successful completion of any task would incomplete
                    without the mention of the people who made it possible, whose constant guidance and encouragement
                    crowned our effort with success. </p>
            </div>
        </div>

        <div class="container grid grid-three--cols" style="display: flex; justify-content: space-evenly;">

            <div class="aknowledgement-div">
                <br>
                <h3>Dr. Shrwan Ram</h3>
                <br>
                <br>
                <p> We would also like to convey our gratitude to Dr. Shrwan Ram, Head of the Department of Computer
                    Science, for his
                    guidance and mentorship, which have been invaluable in
                    shaping our project. </p>
            </div>

            <div class="aknowledgement-div">
                <h3> Miss Harsha Ma'am </h3>
                <p> Furthermore, we extend our thanks to Harsha Ma'am (Assistant Professor)
                    of the Computer Science Department for their expertise and
                    support, which have played a significant role in the
                    development of our project. Their insights and feedback have
                    greatly enriched our learning experience. </p>
            </div>

        </div>
    </section>

    <!-- ========== Start About Section ========== -->

    <section class="about-section" id="about">
        <div class="container">
            <div class="title-heading">
                <h2> About </h2>
            </div>
        </div>

        <div class="container">
            <div class="about-conatent">
                <p> At Webshot, we are a passionate team of developers committed to
                    revolutionizing the way websites are captured and analyzed. As part of our
                    college project, we embarked on this journey with a shared vision to simplify
                    the process of extracting HTML and CSS code from any website. </p>
            </div>

            <div class="title-heading">
                <h2> Our Team </h2>
            </div>
        </div>

        <div class="container grid grid-five--cols">

            <a href="https://harshit-vyas-portfolio.vercel.app/">
                <div class="about-div">
                    <div class="icon">
                        <figure>
                            <img src="./images/harshit.png" alt="harshit vyas image">
                        </figure>
                    </div>
                    <div class="heading">
                        <h3> Harshit vyas </h3>
                    </div>
                </div>
            </a>


            <div class="about-div">
                <div class="icon">
                    <figure>
                        <img src="./images/Lokesh.png" alt="Lokesh Mewara Image">
                    </figure>
                </div>
                <div class="heading">
                    <h3> Lokesh Mewara </h3>
                </div>
            </div>

            <div class="about-div">
                <div class="icon">
                    <figure>
                        <img src="./images/vasudev.png" alt="Vasudev image">
                    </figure>
                </div>
                <div class="heading">
                    <h3> Vasudev </h3>
                </div>
            </div>
        </div>
    </section>
    <!-- ========== End About Section ========== -->

    <!-- ========== Start Resourses Section ========== -->
    <section class="resources-section" id="tech">
        <div class="container">
            <div class="title-heading">
                <h2> Tech. Used </h2>
            </div>
        </div>

        <div class="container grid grid-five--cols">
            <div class="resources-div">
                <div class="icon"> <i class="fa-brands fa-html5"></i> </div>
            </div>

            <div class="resources-div">
                <div class="icon"> <i class="fa-brands fa-css3-alt"></i> </div>
            </div>

            <div class="resources-div">
                <div class="icon"> <i class="fa-brands fa-js"></i> </div>
            </div>

            <div class="resources-div">
                <div class="icon"> <i class="fa-brands fa-python"></i> </div>
            </div>

            <div class="resources-div">
                <div class="icon"> <i class="fa-brands fa-figma"></i> </div>
            </div>

            <div class="resources-div">
                <div class="icon"> <img class="threejs-logo" style="
                    width: 100px;
                    border-radius: 50%;
                    object-fit: cover;
                    height: 100px;"
                        src="https://canada1.discourse-cdn.com/flex035/uploads/threejs/original/2X/e/e4f86d2200d2d35c30f7b1494e96b9595ebc2751.png"
                        alt="Three.js Logo"> </div>
            </div>


            <div class="resources-div">
                <div class="icon"> <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24">
                        <path fill="currentColor"
                            d="M19.455 8.369c-.538-.748-1.778-2.285-3.681-4.569a447 447 0 0 0-1.884-2.245l-.488-.576l-.207-.245l-.113-.133l-.022-.032l-.01-.005L12.57 0l-.609.488a13.34 13.34 0 0 0-3.681 4.64a11.4 11.4 0 0 0-1.043 3.176a12 12 0 0 0-.121.738a11 11 0 0 0-.632-.033l-.059-.003a7.5 7.5 0 0 0-2.28.274l-.317.089l-.163.286a9.6 9.6 0 0 0-1.252 4.416a9.53 9.53 0 0 0 1.583 5.625a9.57 9.57 0 0 0 4.42 3.611l.236.095l.071.025l.003-.001a9.6 9.6 0 0 0 2.941.568q.171.006.342.006a9.5 9.5 0 0 0 3.69-.742l.008.004l.313-.145a9.63 9.63 0 0 0 3.927-3.335a9.6 9.6 0 0 0 1.641-5.042c.075-2.161-.643-4.304-2.133-6.371m-7.083 6.695c.328 1.244.264 2.44-.191 3.558c-1.135-1.12-1.967-2.352-2.475-3.665c-.543-1.404-.87-2.74-.974-3.975c.48.157.922.366 1.315.622c1.132.737 1.914 1.902 2.325 3.461zm.207 6.022c.482.368.99.712 1.513 1.028a7.9 7.9 0 0 1-2.369.273a8 8 0 0 1-.373-.022a9 9 0 0 0 1.228-1.279zm1.347-6.431c-.516-1.957-1.527-3.437-3.002-4.398a7.4 7.4 0 0 0-2.194-.95a9 9 0 0 1 .089-.713a11.6 11.6 0 0 1 .91-2.765l.004-.008c.177-.358.376-.719.61-1.105l.092-.152l-.003-.001a11.7 11.7 0 0 1 1.942-2.311l.288.341c.672.796 1.304 1.548 1.878 2.237c1.291 1.549 2.966 3.583 3.612 4.48c1.277 1.771 1.893 3.579 1.83 5.375a7.97 7.97 0 0 1-3.995 6.641a15.5 15.5 0 0 1-2.539-1.599c.79-1.575.952-3.28.479-5.072zm-2.575 5.397a7.9 7.9 0 0 1-2.09 1.856a6 6 0 0 1-.243-.093l-.065-.026a7.97 7.97 0 0 1-3.635-3.01a7.94 7.94 0 0 1-1.298-4.653a7.9 7.9 0 0 1 .882-3.379q.476-.105.96-.131l.084-.002q.245-.005.478 0q.341.017.677.07c.073 1.513.445 3.145 1.105 4.852c.637 1.644 1.694 3.162 3.144 4.515z" />
                    </svg> </div>
            </div>
        </div>
    </section>
    <!-- ========== End Resourses Section ========== -->

    <!-- ========== Start URL Box Section ========== -->
    <section class="url-box--section" id="urlbox">
        <div class="container">
            <div class="title-heading">
                <center>
                    <h2> Transforms URLs into </h2>
                    <p> Copy Link of Webpage | Paste in the box | Click on generate </p>
                </center>
            </div>
            <div class="url-box">
                <form method="POST">
                    <center><input type="text" name="url" placeholder="Enter Your URL to extract code" required>
                    </center>
                    <center><button type="submit" class="submit-btn" id="generateButton">Generate</button></center>
                </form>

                {% if data %}
                <div class="scraped-data">
                    <h2>Scraped HTML:</h2>
                    <div id="scrollable-box">
                        <!-- The content will be displayed inside this box -->
                        <div id="html-content">{{ data.html | e }}</div>
                    </div>

                    <br>
                    <br>
                    <a href="{{ url_for('download', file_type='html', url=request.form['url']) }}">Download HTML</a>

                    <h2>CSS Links:</h2>
                    <ul>
                        {% for link in data.css_links %}
                        <li><a href="{{ link }}" target="_blank">{{ link }}</a></li>
                        {% endfor %}
                    </ul>
                    <br>
                    <br>
                    <a href="{{ url_for('download', file_type='css', url=request.form['url']) }}">Download CSS Links</a>

                    <h2>JavaScript Links:</h2>
                    <ul>
                        {% for link in data.js_links %}
                        <li><a href="{{ link }}" target="_blank">{{ link }}</a></li>
                        {% endfor %}
                    </ul>

                    <br>
                    <br>
                    <a href="{{ url_for('download', file_type='js', url=request.form['url']) }}">Download JS Links</a>
                </div>
                {% endif %}
            </div>
        </div>
    </section>
    <!-- ========== End URL Box Section ========== -->

    <!-- ========== Contact Section ========== -->
    <section class="footer" id="contach">
        <div class="footer-content">
            <!-- Company Logo 
            <img src="your-logo.png" alt="Company Logo" class="footer-logo">-->

            <!-- Tagline -->
            <p class="footer-tagline">
                High level experience in web design and development knowledge producing quality work.
            </p>

            <!-- Contact Us Button -->
            <button class="contact-button">Contact Us</button>

            <!-- Social Media Icons -->
            <div class="social-icons">
                <a href="https://facebook.com"><i class="fab fa-facebook"></i></a>
                <a href="https://in.linkedin.com"><i class="fab fa-linkedin"></i></a>
                <a href="https://github.com"><i class="fab fa-github"></i></a>
                <a href="https://www.instagram.com"><i class="fab fa-instagram"></i></a>
                <a href="https://telegram.org"><i class="fab fa-telegram"></i></a>
                <a href="https://discord.com"><i class="fab fa-discord"></i></a>
            </div>
        </div>

        <!-- Wave Image -->
        <div class="wave-container">
            <!-- <img src="../Project/images/waves.png" alt="Wave Design" class="wave-image"> -->

            <p class="footer-bottom">
                © 2025 All rights reserved.
            </p>

            <!-- count -->
            <h1 id="countDisplay">Loading count...</h1>
        </div>
    </section>

    <!-- The Popup -->
    <div class="popup-overlay" id="popup">
        <div class="popup-box">
            <span class="borderLine"></span>
            <i>
                <button class="close-btn" id="closePopup">&times;</button>
                <h2 style="color: white;">Welcome to Our Website!</h2><br>
                <p>We hope you have a great experience. Click the button below to continue.</p>
                <button id="continueButton" class="continue">Continue</button>
            </i>
        </div>
            
    </div>

    <!-- logic for count -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";
        import { getFirestore, doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAT53j_k9Alzr7O2HDmeQ8_tfZTdQnde48",
            authDomain: "webshot-c0c2a.firebaseapp.com",
            databaseURL: "https://webshot-c0c2a-default-rtdb.firebaseio.com",
            projectId: "webshot-c0c2a",
            storageBucket: "webshot-c0c2a.firebasestorage.app",
            messagingSenderId: "917217158557",
            appId: "1:917217158557:web:4715f7e0bf7208cf79bb74",
            measurementId: "G-E8JJ3NZ6KE"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        const countDisplay = document.getElementById("countDisplay");
        const generateButton = document.getElementById("generateButton");
        const loginBtn = document.getElementById("login-btn");
        const profileText = document.getElementById("profile-text");
        const logoutButton = document.getElementById("logout-btn");
        const popup = document.getElementById("popup");
        const closeBtn = document.getElementById("closePopup");
        const continueBtn = document.getElementById("continueButton");

        let count = 1;

        // Decrease the count in Firestore
        async function decrementFirestoreCount(uid) {
            try {
                const userDocRef = doc(db, "users", uid);
                const userSnapshot = await getDoc(userDocRef);

                if (userSnapshot.exists()) {
                    const currentCount = userSnapshot.data().count || 0;

                    if (currentCount >= 0) {
                        const newCount = currentCount - 1;
                        await updateDoc(userDocRef, { count: newCount });
                        count = newCount;
                        countDisplay.textContent = `Remaining Try's: ${count}`;
                        generateButton.disabled = count === 0;
                    } else {
                        alert("No tries left! Please Pay us to increase your count.");
                        generateButton.disabled = true;
                    }
                } else {
                    console.error("User document does not exist in Firestore.");
                }
            } catch (error) {
                console.error("Error decrementing count in Firestore:", error);
            }
        }

        generateButton.addEventListener("click", async () => {
            if (count > 0) {
                const dataAvailable = document.querySelector(".scraped-data"); // Check if data is displayed in the DOM

                if (dataAvailable) {
                    onAuthStateChanged(auth, (user) => {
                        if (user) {
                            decrementFirestoreCount(user.uid); // Decrement count in Firestore for logged-in users
                        } else {
                            count--; // Decrement locally for anonymous users
                            countDisplay.textContent = `Remaining Try's: ${count}`;
                            generateButton.disabled = count === 0;
                            alert("You clicked Generate!");
                        }
                    });
                } else {
                    alert("You Used One Try!!");
                }
            } else {
                alert("No tries left. Please log in or increase your count!");
            }
        });

        // Show popup on page load
        window.addEventListener('load', () => {
            popup.style.display = 'flex';
        });

        closeBtn.addEventListener('click', () => {
            popup.style.display = 'none';
        });

        continueBtn.addEventListener('click', () => {
            popup.style.display = 'none';
        });

        logoutButton.addEventListener('click', () => {
            signOut(auth).then(() => {
                alert('User logged out successfully!');
                window.location.href = "{{ url_for('register') }}";
            }).catch((error) => {
                console.error("Error logging out:", error);
            });
        });

        // Check authentication state and fetch count
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                const userDocRef = doc(db, "users", user.uid);

                try {
                    const docSnapshot = await getDoc(userDocRef);
                    count = docSnapshot.exists() ? docSnapshot.data().count || 0 : 0;
                } catch (error) {
                    console.error("Error fetching count:", error);
                    count = 1;
                }

                countDisplay.textContent = `Remaining Try's: ${count}`;
                generateButton.disabled = count === 0;
                loginBtn.style.display = 'none';
                profileText.style.display = 'inline';
                logoutButton.style.display = 'inline';
            } else {
                count = 1;
                countDisplay.textContent = "You have 1 default try. Log in to get more!";
                generateButton.disabled = false;
                loginBtn.style.display = 'inline';
                profileText.style.display = 'none';
                logoutButton.style.display = 'none';
            }
        });

        loginBtn.addEventListener('click', () => {
            window.location.href = "{{ url_for('login') }}";
        });
    </script>

</body>

</html>